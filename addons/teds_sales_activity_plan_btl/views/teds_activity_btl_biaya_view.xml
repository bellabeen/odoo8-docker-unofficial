<?xml version="1.0"?>
<openerp>
	<data>
		<record id="view_teds_activity_btl_biaya_tree" model="ir.ui.view">
			<field name="name">teds.activity.btl.biaya.tree</field>
			<field name="model">teds.activity.btl.biaya</field>
			<field name="arch" type="xml">
				<tree> 
					<field name="branch_id"/>
					<field name="activity_id"/>
					<field name="tanggal"/>
					<field name="total_biaya"/>
					<field name="state"/>
				</tree>
			</field>
		</record>

		<record id="view_teds_activity_btl_biaya_form" model="ir.ui.view">
			<field name="name">teds.activity.btl.biaya.form</field>
			<field name="model">teds.activity.btl.biaya</field>
			<field name="arch" type="xml">
				<form>
					<header>
						<button name="action_rfa" string="RFA" type="object" class="oe_highlight" states="draft"/>
						<button name="action_approved" string="Approved" type="object" class="oe_highlight" states="waiting_for_approval"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,waiting_for_approval,approved"/>
					</header>
					<group>
						<group>
							<field name="branch_id" required="1" options="{'no_open':True,'no_create':True}" attrs="{'readonly':[('state','!=','draft')]}"/>
							<field name="activity_id" required="1" options="{'no_open':True,'no_create':True}" attrs="{'readonly':[('state','!=','draft')]}"/>
						</group>
						<group>
							<field name="tanggal" readonly="1"/>
							<field name="total_biaya" invisible="1"/>
							<field name="total_biaya_show" readonly="1"/>
						</group>
					</group>
					<notebook>
						<page string="Detail">
							<field name="detail_biaya_ids" nolabel="1" attrs="{'readonly':[('state','!=','draft')]}">
								<tree editable='top'>
									<field name="type" required="1"/>
									<field name="finco_id" required="1" options="{'no_open':True,'no_create':True}"/>
									<field name="move_line_id" required="1" options="{'no_open':True,'no_create':True}" domain="[('id','=',0)]"/>
									<field name="amount_hl_original"/>
									<field name="amount_hl_balance"/>
									<field name="amount_alokasi" required="1" sum="Total"/>
								</tree>
							</field>
						</page>
						<page string="Audit Trail">
							<group>
								<group>
									<field name="create_uid" readonly="1"></field>
									<field name="create_date" readonly="1"></field>
									<field name="approved_uid" attrs="{'invisible':[('approved_uid','=',False)]}" readonly="1"></field>
									<field name="approved_date" attrs="{'invisible':[('approved_date','=',False)]}" readonly="1"></field>
								</group>
								<group>							
									<field name="write_uid" readonly="1"></field>
									<field name="write_date" readonly="1"></field>
								</group>
							</group>
						</page>	
					</notebook>
				</form>
			</field>
		</record>

		<record id="teds_activity_btl_biaya_filter" model="ir.ui.view">
            <field name="name">teds.activity.btl.biaya.filter</field>
            <field name="model">teds.activity.btl.biaya</field>
            <field name="arch" type="xml">
                <search string="Search">
                    <field name="activity_id"/>
                    <field name="branch_id"/>
                    <filter string="Draft" name="state_draft" domain="[('state','=','draft')]" />
                    <filter string="Waiting for Approval" name="state_waiting_for_approval" domain="[('state','=','waiting_for_approval')]"/>
                    <filter string="Approved" name="state_approved" domain="[('state','=','approved')]"/>

                    <group expand="1" string="Group By">
                        <filter context="{'group_by':'branch_id'}" string="Branch"/>
                        <filter context="{'group_by':'activity_id'}" string="Activity"/>
                    </group>     
                </search>
            </field>
        </record>        

		<record id="action_teds_activity_btl_biaya" model="ir.actions.act_window">
            <field name="name">Pengajuan Biaya BTL</field>
            <field name="res_model">teds.activity.btl.biaya</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_state_draft':1,'search_default_state_waiting_for_approval':1,'search_default_state_approved':1}</field>
        </record>

    	<menuitem id="teds_activity_btl_biaya_menuitem" action="action_teds_activity_btl_biaya" parent="teds_sales_activity_btl_menu" sequence="04"/>

	</data>
</openerp>