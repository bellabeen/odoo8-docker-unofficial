<?xml version="1.0"?>
<openerp>
	<data>
		<record id="view_teds_sales_result_activity_tree" model="ir.ui.view">
			<field name="name">teds.sales.result.activity.tree</field>
			<field name="model">teds.sales.plan.activity</field>
			<field name="priority">5</field>
			<field name="arch" type="xml">
				<tree create='false' edit='false' delete='false'>
					<field name="branch_id"/>
					<field name="name"/>
					<field name="bulan"/>
					<field name="tahun"/>
				</tree>
			</field>
		</record>
		
		<record id="view_teds_sales_result_activity_form" model="ir.ui.view">
			<field name="name">teds.sales.result.activity.form</field>
			<field name="model">teds.sales.plan.activity</field>
			<field name="priority">5</field>
			<field name="arch" type="xml">
				<form create="false" delete="false" edit="false">
					<header>
						<button name="get_done_act" string="Done" type="object" groups="teds_sales_activity_plan_btl.group_done_result_activity_button"/>
						<field name="state" widget="statusbar" statusbar_visible="confirmed,done"/>
					</header>
					<div class="oe_title">
						<h1>
							<field name="name" attrs="{'invisible':[('name','=',False)]}" readonly="1"/>	
						</h1>
					</div>
					<group>
						<field name="branch_id" options="{'no_open':True,'no_create':True}" readonly="1" attrs="{'readonly':[('name','!=',False)]}"/>
						<label for="bulan" string="Periode"/>
                        <div>
                            <field name="bulan" readonly="1" class="oe_inline" attrs="{'readonly':[('state','!=','draft')]}"/> 
                            <field name="tahun" readonly="1" class="oe_inline" attrs="{'readonly':[('state','!=','draft')]}"/>
                        </div>
                        <field name="total_biaya_btl"/>
					</group>
					<notebook>
						<page string="Detail">
							<field name="activity_line_ids" nolabel="1" attrs="{'readonly':[('state','!=','draft')]}">
								<tree>
									<field name="jaringan_penjualan"/>
									<field name="name"/>
									<field name="act_type_id" options="{'no_open':True,'no_create':True}"/>
									<field name="titik_keramaian_id" options="{'no_open':True,'no_create':True}"/>
									<field name="kecamatan_id" options="{'no_open':True,'no_create':True}"/>
									<field name="start_date"/>
									<field name="end_date"/>
									<field name="target_unit"/>
									<field name="target_customer"/>
									<field name="actual_unit"/>
									<field name="actual_customer"/>
								</tree>
								<form>
									<sheet>
				                        <group>
											<group>
												<field name="branch_id" invisible="1"/>
												<field name="state" invisible="1"/>
												<field name="jaringan_penjualan" readonly="1" attrs="{'readonly':[('branch_id','=',False)]}"/>
												<field name="act_type_id" options="{'no_open':True,'no_create':True}" readonly="1" attrs="{'readonly':[('branch_id','=',False)]}"/>
												<field name="titik_keramaian_id" options="{'no_open':True,'no_create':True}" readonly="1" domain="[('branch_id','=',branch_id)]"/>
												<field name="ring_id" options="{'no_open':True,'no_create':True}"/>
				                          		<field name="name" readonly="1"/>
												<field name="is_location"/>
												<field name="source_pos_location_id" attrs="{'invisible':['|',('is_location','=',False),('jaringan_penjualan','!=','POS')],'required':[('is_location','!=',False),('jaringan_penjualan','=','POS')]}" options="{'no_open':True,'no_create':True}" domain="[('branch_id','=',branch_id),('jenis','=','pos')]"/>
												<field name="jenis_pengajuan" attrs="{'invisible':[('is_location','=',False)],'required':[('is_location','!=',False)]}"/>
												<field name="location_id" options="{'no_open':True,'no_create':True}" domain="[('id','=',0)]" attrs="{'invisible':['|',('jenis_pengajuan','!=','update'),('is_location','=',False)],'required':[('jenis_pengajuan','=','update')]}"/>
				                          		<field name="name" attrs="{'invisible':[('jenis_pengajuan','=','update')],'required':[('jenis_pengajuan','=','new')]}"/>
				                          		<field name="display_unit" attrs="{'invisible':[('is_location','=',False)],'required':[('is_location','!=',False)]}"/>
												<field name="target_unit" required="1"/>
												<field name="target_customer" required="1"/>
				                          	</group>
				                          	<group>
												<label for="start_date" string="Periode"/>
						                        <div>
						                            <field name="start_date" readonly="1" placeholder="Start Date" class="oe_inline"/> - 
						                            <field name="end_date" readonly="1" placeholder="End Date" class="oe_inline"/>
						                        </div>
						                        <field name="pic_id" options="{'no_open':True,'no_create':True}" readonly="1"/>
												<field name="nik"/>
												<field name="job"/>
												<field name="no_telp" readonly="1"/>
												<field name="actual_unit"/>
												<field name="actual_customer"/>
											</group>
										</group>
										<group string="Address">
											<group>
												<field name="street" attrs="{'readonly':[('is_location','!=',False)]}"/>
												<field name="rt" class="oe_inline"/>
												<field name="rw" class="oe_inline"/>
											</group>
											<group>
												<field name="state_id" options="{'no_open':True,'no_create':True}" readonly="1"/>
												<field name="city_id" options="{'no_open':True,'no_create':True}" readonly="1"/>
												<field name="kecamatan_id" options="{'no_open':True,'no_create':True}"/>
												<field name="kelurahan_id" options="{'no_open':True,'no_create':True}" attrs="{'readonly':[('is_location','!=',False)]}"/>
											</group>
										</group>
										<group string="Biaya">
											<field name="total_biaya" readonly="1"/>
											<field name="detail_biaya_ids" string="Detail Biaya" readonly="1">
												<tree editable="bottom">
													<field name="name" required="1"/>
													<field name="finco_id" attrs="{'readonly':[('name','!=','Leasing')],'required':[('name','=','Leasing')]}" options="{'no_open':True,'no_create':True}"/>
													<field name="tipe"/>
													<field name="amount" required="1" sum="Total"/>
													<field name="is_ppn" readonly="1"/>
													<field name="subtotal"/>
													<field name="state" invisible="1"/>
												</tree>
											</field>
										</group>
										<group string="History Activity">
											<field name="qty_customer_last" readonly="1"/>
											<field name="history_location_ids" string="Unit 3 Bulan Terakhir">
												<tree readonly="1">
													<field name="name"/>
													<field name="qty" sum="Total"/>
												</tree>
												<form>
													<sheet>
														<group>
															<field name="name"/>
															<field name="qty"/>
														</group>
														<notebook>
															<page string="Detail Pencapaian">
																<field name="detail_ids" nolabel="1">
																	<tree>
																		<field name="product_id" options="{'no_open':True,'no_create':True}"/>
																		<field name="categ_id" options="{'no_open':True,'no_create':True}"/>
																	</tree>
																	<form>
																		<sheet>
																			<group>
																				<field name="product_id" options="{'no_open':True,'no_create':True}"/>
																				<field name="categ_id" options="{'no_open':True,'no_create':True}"/>
																			</group>
																		</sheet>
																	</form>
																</field>
															</page>
														</notebook>
													</sheet>
												</form>
											</field>
										</group>
										<group string="Actual Plan" attrs="{'invisible':[('state','!=','done')]}">
											<notebook>
												<page string="SPK">
													<field name="spk_ids" readonly="1">
														<tree editable="top">
															<field name="name" string="No SPK"/>
															<field name="date_order"/>
															<field name="partner_id"/>
														</tree>
													</field>
												</page>
												<page string="Sales Order">
													<field name="dso_ids" readonly="1">
														<tree editable="top">
															<field name="name" string="No Sales Order"/>
															<field name="date_order"/>
															<field name="partner_id"/>
														</tree>
													</field>
												</page>
											</notebook>
										</group>
									</sheet>
								</form>
							</field>
						</page>
						<page string="Audit Trail">
							<group>
								<group>
									<field name="create_uid" readonly="1"/>
									<field name="create_date" readonly="1"/>
									<field name="approved_am_uid" readonly="1" attrs="{'invisible':[('approved_am_uid','=',False)]}"/>
									<field name="approved_am_date" readonly="1" attrs="{'invisible':[('approved_am_date','=',False)]}"/>
								</group>
								<group>							
									<field name="write_uid" readonly="1"/>
									<field name="write_date" readonly="1"/>
									<field name="approved_operation_uid" readonly="1" attrs="{'invisible':[('approved_operation_uid','=',False)]}"/>
									<field name="approved_aoperation_date" readonly="1" attrs="{'invisible':[('approved_aoperation_date','=',False)]}"/>
								</group>
							</group>
						</page>
					</notebook>
				</form>
			</field>
		</record>

        <record id="action_teds_sales_result_activity" model="ir.actions.act_window">
            <field name="name">Activity Result</field>
            <field name="res_model">teds.sales.plan.activity</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state','in',('approved','open','done'))]</field>
            <field name="context">{'search_default_state_open':1}</field>
        </record>
        
        <record id="action_teds_sales_result_activity_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_teds_sales_result_activity_tree"/>
            <field name="act_window_id" ref="action_teds_sales_result_activity"/>
        </record>
            
        <record id="action_teds_sales_result_activity_form" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_teds_sales_result_activity_form"/>
            <field name="act_window_id" ref="action_teds_sales_result_activity"/>
        </record>

    	<menuitem id="teds_sales_result_activity_menuitem" action="action_teds_sales_result_activity" parent="teds_sales_activity_btl_menu" sequence="06"/>
	</data>
</openerp>