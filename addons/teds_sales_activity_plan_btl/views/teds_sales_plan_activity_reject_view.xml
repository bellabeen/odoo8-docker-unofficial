<?xml version="1.0"?>
<openerp>
	<data>
		<record id="view_teds_spa_status_reject_tree" model="ir.ui.view">
			<field name="name">teds.spa.status.reject.tree</field>
			<field name="model">teds.sales.plan.activity.line</field>
			<field name="arch" type="xml">
				<tree create="false" delete="false">
					<field name="branch_id"/>
					<field name="jaringan_penjualan"/>
					<field name="name"/>
					<field name="act_type_id" options="{'no_open':True,'no_create':True}"/>
					<field name="ring_id" options="{'no_open':True,'no_create':True}"/>
					<field name="kecamatan_id" options="{'no_open':True,'no_create':True}"/>
					<field name="jenis_pengajuan"/>
					<field name="location_id"/>
					<field name="start_date"/>
					<field name="end_date"/>
					<field name="display_unit"/>
					<field name="state"/>
				</tree>
			</field>
		</record>

		<record id="view_teds_spa_status_reject_form" model="ir.ui.view">
			<field name="name">teds.spa.status.reject.form</field>
			<field name="model">teds.sales.plan.activity.line</field>
			<field name="arch" type="xml">
				<form create="false" delete="false">
					<header>
						<button name="action_revisi_activity" string="Confirm" type="object" class="oe_highlight"  attrs="{'invisible':[('state','!=','reject')]}"/>
					</header>
					<sheet>
	                    <group>
							<group>
								<field name="branch_id" invisible="1"/>
								<field name="activity_id" invisible="1"/>
								<field name="jaringan_penjualan" required="1" attrs="{'readonly':[('state','!=','reject')]}"/>
								<field name="act_type_id" options="{'no_open':True,'no_create':True}" required="1" attrs="{'readonly':[('state','!=','reject')]}"/>
								<field name="titik_keramaian_id" options="{'no_open':True,'no_create':True}" required="1" domain="[('branch_id','=',branch_id)]" attrs="{'readonly':[('state','!=','reject')]}"/>
								<field name="ring_id" options="{'no_open':True,'no_create':True}" attrs="{'readonly':[('state','!=','reject')]}"/>
								<field name="is_location"/>
								<field name="source_pos_location_id" attrs="{'invisible':['|',('is_location','=',False),('jaringan_penjualan','!=','POS')],'required':[('is_location','!=',False),('jaringan_penjualan','=','POS')],'readonly':[('state','!=','reject')]}" options="{'no_open':True,'no_create':True}" domain="[
													('branch_id','=',branch_id),
													('jenis','=','pos'),
													('start_date','&lt;=',context_today().strftime('%Y-%m-%d')),
													('end_date','&gt;=',context_today().strftime('%Y-%m-%d'))
													]"/>
								<field name="jenis_pengajuan" attrs="{'invisible':[('is_location','=',False)],'required':[('is_location','!=',False)],'readonly':[('state','!=','reject')]}"/>
								<field name="location_id" options="{'no_open':True,'no_create':True}" domain="[('branch_id','=',branch_id),('usage','=','internal'),('jenis','in',('pameran','channel','canvasing'))]" attrs="{'invisible':['|',('jenis_pengajuan','!=','update'),('is_location','=',False)],'required':[('jenis_pengajuan','=','update')],'readonly':[('state','!=','reject')]}"/>
                          		<field name="name" attrs="{'required':['|',('is_location','=',False),('jenis_pengajuan','=','new')],'readonly':[('state','!=','reject')]}"/>
                          		<field name="display_unit" attrs="{'invisible':[('is_location','=',False)],'required':[('is_location','!=',False)],'readonly':[('state','!=','reject')]}"/>
								<field name="target_unit" required="1" attrs="{'readonly':[('state','!=','reject')]}"/>
								<field name="target_customer" required="1" attrs="{'readonly':[('state','!=','reject')]}"/>
                          	</group>
                          	<group>
								<label for="start_date" string="Periode"/>
		                        <div>
		                            <field name="start_date" required="1" placeholder="Start Date" class="oe_inline" attrs="{'readonly':[('state','!=','reject')]}"/> - 
		                            <field name="end_date" required="1" placeholder="End Date" class="oe_inline" attrs="{'readonly':[('state','!=','reject')]}"/>
		                        </div>
		                        <field name="pic_id" options="{'no_open':True,'no_create':True}" required="1" attrs="{'readonly':[('state','!=','reject')]}"/>
								<field name="nik"/>
								<field name="job"/>
								<field name="no_telp" required="1" attrs="{'invisible':[('status_operation','!=','reject')]}"/>
								<field name="foto" attrs="{'invisible':[('is_location','=',False)]}" widget="image" img_height="200" width="350" height="200" filename="filename_foto"/>
								<field name="filename_foto" invisible="1"/>
							</group>
							<group string="Address">
								<group>
									<field name="street" attrs="{'required':[('is_location','!=',False)],'readonly':[('state','!=','reject')]}"/>
									<field name="rt" class="oe_inline" attrs="{'readonly':[('state','!=','reject')]}"/>
									<field name="rw" class="oe_inline" attrs="{'readonly':[('state','!=','reject')]}"/>
									<field name="state_id" options="{'no_open':True,'no_create':True}" readonly="1"/>
									<field name="city_id" options="{'no_open':True,'no_create':True}" readonly="1"/>
									<field name="kecamatan_id" options="{'no_open':True,'no_create':True}"/>
									<field name="kelurahan_id" options="{'no_open':True,'no_create':True}" attrs="{'readonly':[('state','!=','reject')]}"/>
								</group>
							</group>
							<group attrs="{'invisible':[('state','=','draft')]}">
								<group string="Status AM">
									<field name="status_am" readonly="1" attrs="{'invisible':[('status_am','=',False)]}"/>
									<field name="reason_reject_am" readonly="1" attrs="{'invisible':[('status_am','!=','reject')]}"/>
								</group>
								<group string="Status Operational">
									<field name="state" string="Status Location" readonly="1"/>
									<field name="reason_reject_location" readonly="1" attrs="{'invisible':[('reason_reject_location','=',False)]}"/>
									<field name="status_operation" readonly="1" attrs="{'invisible':[('status_operation','=',False)]}" string="Status Operational"/>
									<field name="reason_reject_operation" readonly="1" attrs="{'invisible':[('status_operation','!=','reject')]}"/>
								</group>
							</group>
						</group>
						<group string="Biaya">
							<field name="total_biaya" readonly="1"/>
							<field name="detail_biaya_ids" string="Detail Biaya" attrs="{'readonly':[('state','!=','reject')]}">
								<tree editable="bottom">
									<field name="name" required="1"/>
									<field name="finco_id" attrs="{'readonly':[('name','!=','Leasing')],'required':[('name','=','Leasing')]}" options="{'no_open':True,'no_create':True}"/>
									<field name="tipe" required="1"/>
									<field name="amount" required="1" sum="Total"/>
									<field name="is_ppn" readonly="1"/>
									<field name="subtotal"/>
									<field name="state" invisible="1"/>
								</tree>
							</field>
						</group>
						<group string="History Activity">
							<field name="qty_customer_last" readonly="1"/>
							<field name="history_location_ids" string="Unit 3 Bulan Terakhir">
								<tree create='false' edit='false' delete='false'>
									<field name="name"/>
									<field name="qty" sum="Total"/>
								</tree>
								<form>
									<sheet>
										<group>
											<field name="name"/>
											<field name="qty"/>
										</group>
										<notebook>
											<page string="Detail Pencapaian">
												<field name="detail_ids" nolabel="1">
													<tree>
														<field name="product_id" options="{'no_open':True,'no_create':True}"/>
														<field name="categ_id" options="{'no_open':True,'no_create':True}"/>
													</tree>
													<form>
														<sheet>
															<group>
																<field name="product_id" options="{'no_open':True,'no_create':True}"/>
																<field name="categ_id" options="{'no_open':True,'no_create':True}"/>
															</group>
														</sheet>
													</form>
												</field>
											</page>
										</notebook>
									</sheet>
								</form>
							</field>
						</group>
					</sheet>
				</form>
			</field>
		</record>

        <record id="action_teds_spa_status_reject" model="ir.actions.server">
            <field name="name">Activity &amp; BTL Reject</field>
            <field name="model_id" ref="teds_sales_activity_plan_btl.model_teds_sales_plan_activity_line"/>
            <field name="code">
                action = env['teds.sales.plan.activity.line'].action_spa_status_reject_tree()
            </field>
        </record>

    	<menuitem id="teds_spa_status_reject_menuitem" action="action_teds_spa_status_reject" parent="teds_sales_activity_btl_menu" sequence="03"/>

	</data>
</openerp>