<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data> 
    	
		<record model="ir.ui.view" id="banktransfer_tree_view">
		    <field name="name">wtc.bank.transfer.tree.view</field>
		    <field name="model">wtc.bank.transfer</field>
		    <field name="arch" type="xml">
		        <tree string="List Bank Transfer">
		        	<field name="name"/>
		            <field name="branch_id"/>
					<field name="date"/>	            		            			            	
		            <field name="state"/>
		            	            
		        </tree>
		     </field>
		</record>
		    	
		<record model="ir.ui.view" id="banktransfer_form_view">
		    <field name="name">wtc.bank.transfer.form.view</field>
		    <field name="model">wtc.bank.transfer</field>
		    <field name="arch" type="xml">		       	        	
				<form>
					<header>
						<button name="banktranster_post" groups='wtc_bank_transfer.group_wtc_bank_transfer_confirm_approval' states="app_approve" string="Post" type="workflow" class="oe_highlight"/>
						<button name="bank_cancel" groups='wtc_bank_transfer.group_wtc_bank_transfer_cancel' states="draft,waiting_for_approval,confirmed" string="Cancel" type="workflow" confirm="Apa anda yakin ingin membatalkan transaksi ini ?"/>
						<button name="print_report_bank_transfer" type="object" string="Print" class="oe_highlight"/>														
						<button name="action_klik_payment" type="object" class="oe_highlight" string="Payment Klik" attrs="{'invisible':['|',('state','not in',('app_approve','approved')),('payment_klik_uid','!=',False)]}" groups="wtc_bank_transfer.group_wtc_bank_transfer_is_payment"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,app_approve,approved" statusbar_colors='{"draft":"red","posted":"blue"}'/>	
	           		</header>
					<sheet>  
	        			<div class="oe_title">
			        		<h2>
				                <label string="Bank Transfer"/>    			
				 				<field name="name" class="oe_inline"/>
			 				</h2>
	 					</div>			        							        	 
						<group col="2" colspan="2">   
							<group>
								<field name="branch_id" options="{'no_create': True,'no_open': True}" attrs="{'readonly': ['|',('state','!=','draft'),('name','!=',False)]}" on_change="branch_id_change(branch_id)"/>
							</group>  
							<group>
								<field name="division" attrs="{'readonly': [('state','!=','draft')]}" />																
							</group>
							<group>
							    <field name="payment_from_id" options="{'no_create': True,'no_open': True}" required="1" attrs="{'readonly': [('state','!=','draft')]}" on_change="change_amount(payment_from_id)"/>								    																									
							</group> 
							<group>
								<field name="date" readonly="1"/>
								<field name="is_payment" readonly="1"/>
								<field name="payment_klik_uid" readonly="1" attrs="{'invisible':[('payment_klik_uid','=',False)]}" options="{'no_open':True,'no_create':True}"/>
                            	<field name="payment_klik_date" readonly="1" attrs="{'invisible':[('payment_klik_date','=',False)]}"/>
							</group>        
							<group colspan="2">
								<field name="description" required="1" attrs="{'readonly': [('state','!=','draft')]}"/> 									                    			                    								    								
				                <field name="amount_show" on_change="change_amount_show(amount_show)" attrs="{'readonly': ['|',('state','!=','draft'),('journal_type','=','cash')]}"/>																											
								<field name="amount" required="1" invisible='1' options="{'no_create': True,'no_open': True}" attrs="{'readonly': [('state','!=','draft')]}" />								    	
				                <field name="journal_type" invisible='1'/>	
				                <field name="account_id" invisible='1'/>	
							</group>														
						</group>
	                    <notebook colspan="5">
	                        <page string="Detail Transfer">
		                        <field colspan="4" name="line_ids" nolabel="1" widget="one2many_list" attrs="{'readonly': [('state','!=','draft')]}">
		                            <tree string="" editable="bottom">
		                            	<field name="reimbursement_id" options="{'no_create': True,'no_open': True}"/>
						                <field name="branch_destination_id" required="1" options="{'no_create': True,'no_open': True}"/>
						                <field name="payment_to_id" required="1" options="{'no_create': True,'no_open': True}"/>
						                <field name="description" required="1"/>
						                <field name="amount" required="1" sum="Total Amount" attrs="{'readonly':[('reimbursement_id','!=',False)]}"/>		
															                       																		                
						             </tree>
		                        </field>
	                            
								<group class="oe_subtotal_footer oe_right">
									<field name="bank_fee" widget='monetary' options="{'currency_field': 'currency_id'}"/>
										<div class="oe_subtotal_footer_seperator oe_inline">
											<label for="amount_total"/>
											<button name="button_dummy"
									        states="draft" string="(update)" type="object" class="oe_edit_only oe_link"/>
										</div>
									<field name="amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget='monetary' options="{'currency_field': 'currency_id'}"/>
								</group>
                             
								<div class="oe_clear"/>
                            	<field name="note" class="oe_inline" placeholder="Note..." readonly="1"/>
	                        </page>
	                        <!-- <page string="Reconcile Items" attrs="{'invisibile': [('journal_type','!=','cash')]}">
	                            <field colspan="4" name="reconcile_ids" nolabel="1" widget="one2many_list" attrs="{'readonly':[('state','!=','draft')]}">
                                    <tree string="" editable="top">
                                        <field name="move_line_id" on_change="onchange_move_line_id(move_line_id, parent.payment_from_id)" domain="[('bank_reconcile_id','=',False),('branch_id','=',parent.branch_id),('account_id','=',parent.account_id)]" />
                                        <field name="ref_original" readonly="1" />
                                        <field name="name" readonly="1" />
                                        <field name="date_original" readonly="1" />
                                        <field name="amount_original" readonly="1" sum="Total Amount"/>
                                    </tree>
                                </field>
	                        </page> -->
	                        <page string="Journal Items" attrs="{'invisible': [('state','in',('draft','waiting_for_approval','app_approve'))]}">
	                            <group col="4">
	                                <field name="period_id"/>
	                            </group>
	                            <field name="move_ids" readonly="1">
	                               <tree string="Journal Items">
	                                   <field name="move_id"/>
	                                   <field name="branch_id"/>
	                                   <field name="ref"/>
	                                   <field name="date"/>
	                                   <field name="statement_id"/>
	                                   <field name="partner_id"/>
	                                   <field name="account_id"/>
	                                   <field name="name"/>
	                                   <field name="debit"/>
	                                   <field name="credit"/>
	                                   <field name="state"/>
	                                   <field name="reconcile_id"/>
	                               </tree>
	                            </field>
	                        </page>                        
	                    </notebook>							   		                																
					</sheet>
				</form>	
		    </field>
		</record>
		
 		<record id="view_banktransfer" model="ir.ui.view">
            <field name="name">banktransfer.list.select</field>
            <field name="model">wtc.bank.transfer</field>
            <field name="arch" type="xml">
                <search string="Search Bank Transfer Out">
                    <field name="name" string="Reference"/>
                    <field name="branch_id"/> 
                    <field name='division'/>
                    <field name='payment_from_id'/>
                    <group expand="0" string="Group By">
                        <filter string="Branch" icon="terp-partner" domain="[]" context="{'group_by':'branch_id'}"/>
                        <filter string="Date" icon="terp-go-month" domain="[]" context="{'group_by':'date'}"/>                    
                    </group>
                </search>
            </field>
        </record>		
		<record model="ir.actions.act_window" id="banktransfer_action">
		    <field name="name">Bank Transfer</field>
		    <field name="res_model">wtc.bank.transfer</field>
		    <field name="view_type">form</field>
		    <field name="view_mode">tree,form</field>
		    <field name="search_view_id" ref="view_banktransfer"/>
		</record>
					
		<menuitem id="banktransfer_submenu" name="Bank Transfer" parent="wtc_dealer_menu.backoffice_bankandcash_menu"  action="banktransfer_action" sequence="5"/> 		
		
	</data>
</openerp>
															
