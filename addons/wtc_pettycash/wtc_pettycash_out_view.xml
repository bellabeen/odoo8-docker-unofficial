<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data> 
    	
		<record model="ir.ui.view" id="pettycash_tree_view">
		    <field name="name">wtc.pettycash.tree.view</field>
		    <field name="model">wtc.pettycash</field>
		    <field name="arch" type="xml">
		        <tree string="List Petty Cash">
		        	<field name="name"/>
		            <field name="branch_id"/>
					<field name="division"/>	            
		            <field name="branch_destination_id"/>	
		            <field name="state"/>	            
		        </tree>
		     </field>
		</record>
		    	
		<record model="ir.ui.view" id="pettycash_form_view">
		    <field name="name">wtc.pettycash.form.view</field>
		    <field name="model">wtc.pettycash</field>
		    <field name="arch" type="xml">		       	        	
				<form>
					<header>
						<button name="post_pettycash" states="draft" string="Post" type="object" invisible="1" class="oe_highlight"/>
						<button name="%(report_petty_cash_out)d" attrs="{'invisible': [('state','not in',('reimbursed','posted'))]}"  string="Print" type="action" class="oe_highlight"/> 
						<field name="state" widget="statusbar" statusbar_visible="draft,posted,reimbursed" statusbar_colors='{"draft":"red","posted":"blue"}'/>	
	           		</header>
					<sheet>          							
			        	<div class="oe_title">
			        		<h2>
				                <label string="Petty Cash Out"/>    			
				 				<field name="name" class="oe_inline"/>
			 				</h2>
			        	</div>       
						<group col="2" colspan="2">   
							<group>
								<field name="branch_id" options="{'no_create': True,'no_open': True}" attrs="{'readonly': ['|',('state','!=','draft'),('name','!=',False)]}" />
							</group>            
						    <group>
	                    		<field name="division" required="1" attrs="{'readonly': [('state','!=','draft')]}" />
	                    	</group>
	                    	<group>
								<field name="branch_destination_id" options="{'no_create': True,'no_open': True}" required="1" attrs="{'readonly': [('state','!=','draft')]}"/>						               	                    			                    		
							    <field name="amount" required="1" attrs="{'readonly': [('state','!=','draft')]}" />								    	
							    <field name="journal_id" required="1" attrs="{'readonly': [('state','!=','draft')]}" options="{'no_create': True,'no_open': True}" />								    	
							</group>
				            <group> 
				            	<field name="date" readonly="1"/> 
				            	<field name="amount_real"/>
				            	<field name="user_id" attrs="{'readonly': [('state','!=','draft')]}"/> 
							    <!--<field name="account_id" required="1" options="{'no_create': True,'no_open': True}" attrs="{'readonly': [('state','!=','draft')]}" />-->								    	
							    																	
							</group>   
						</group>	
						
						<notebook>
		                    <page string="Payment Information">
		                        <field colspan="4" name="line_ids" nolabel="1" widget="one2many_list" attrs="{'readonly': [('state','!=','draft')]}">
		                            <tree string="" editable="bottom">
		                            	<field name="type_id" options="{'no_create': True,'no_open': True}" attrs="{'required':['|',('type_id','!=',False),('name','=',False)]}"/>
		                                <field name="type_detail_id" options="{'no_create': True,'no_open': True}" attrs="{'required':[('type_id','!=',False)]}"/>
		                                <field name="note"/>
                                		<field name="name" invisible="1" required="1"/>
                                		<field name="name_show" readonly="1"/>
                                        <field name="account_id" options="{'no_create': True,'no_open': True}" invisible="1" required="1"/>
		                                <field name="account_show_id" options="{'no_create': True,'no_open': True}" readonly="1"/>
		                                <field name="amount" required="1" sum="Total Amount"/>  
		                                <field name="amount_real" readonly="1" sum="Total Amount Real"/>                
						             </tree>
		                        </field>
		                    </page>   
	                        <page string="Journal Items" attrs="{'invisible': ['|',('state','=','draft'),('state','=','waiting_for_approval')]}">
	                            <group col="4">
	                                <field name="period_id"/>
	                            </group>
	                            <field name="move_ids" readonly="1">
	                               <tree string="Journal Items">
	                                   <field name="move_id"/>
	                                   <field name="branch_id"/>
	                                   <field name="ref"/>
	                                   <field name="date"/>
	                                   <field name="statement_id"/>
	                                   <field name="partner_id"/>
	                                   <field name="account_id"/>
	                                   <field name="name"/>
	                                   <field name="debit"/>
	                                   <field name="credit"/>
	                                   <field name="state"/>
	                                   <field name="reconcile_id"/>
	                               </tree>
	                            </field>
	                        </page>	
		                </notebook>						
					</sheet>
				</form>	
		    </field>
		</record>
		
 		<record id="view_pettycash" model="ir.ui.view">
            <field name="name">pettycash.list.select</field>
            <field name="model">wtc.pettycash</field>
            <field name="arch" type="xml">
                <search string="Search Petty Cash">
                    <field name="name" string="Reference"/>
                    <field name='division'/>
                    <field name="branch_destination_id"/> 
                    <field name="branch_id"/> 
                    <field name="journal_id"/> 
                    <group expand="0" string="Group By">
                        <filter string="Branch" icon="terp-partner" domain="[]" context="{'group_by':'branch_id'}"/>
                        <filter string="Tanggal" icon="terp-go-month" domain="[]" context="{'group_by':'date'}"/>                    
                    </group>
                </search>
            </field>
        </record>		
		<record model="ir.actions.act_window" id="pettycash_action">
		    <field name="name">Petty Cash Out</field>
		    <field name="res_model">wtc.pettycash</field>
		    <field name="view_type">form</field>
		    <field name="view_mode">tree,form</field>
		    <field name="search_view_id" ref="view_pettycash"/>
		</record>
					
		<menuitem id="pettycash_submenu" name="Petty Cash Out" parent="wtc_dealer_menu.backoffice_bankandcash_menu"  action="pettycash_action" sequence="0"/> 		
		
	</data>
</openerp>
															