<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
    
    	<record model="ir.ui.view" id="view_wizard_eksport_upo">
            <field name="name">view.wizard.eksport.upo</field>
            <field name="model">eksport.upo</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form col="4" string="Eksport UPO Wizard" version="7.0">
                    
                    <footer>
                        <button name="export_file" string="Export" type="object" class="oe_highlight"/>
                        or 
                        <button string="Cancel" class="oe_link" special="cancel" />
                    </footer>
                </form>
            </field>
        </record>
               
        <record model="ir.actions.act_window" id="action_export_upo">
            <field name="name">Export Object</field>
            <field name="res_model">eksport.upo</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>
        
    	
        <record id="view_wtc_p2p_purchase_tree" model="ir.ui.view">
            <field name="name">wtc.p2p.purchase.order.line.tree</field>
            <field name="model">wtc.p2p.purchase.order</field>
            <field eval="1" name="priority"/>
            <field name="arch" type="xml">
                <tree string="P2P Purchase Order">
                    <field name="name"/>
                    <field name="supplier_id"/>
                    <field name="dealer_id"/>
                    <field name="date"/>
                    <field name="purchase_order_type_id"/>
                    <field name="periode_id"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>    	
 
		<record model="ir.ui.view" id="wtc_p2p_purchase_form_view">
		    <field name="name">wtc.p2p.purchase.order.form</field>
		    <field name="model">wtc.p2p.purchase.order</field>
		    <field name="arch" type="xml">
		        <form string="P2P Purchase Order">	 
					<header>
							<button name="%(report_p2p_purchase_order)d"  attrs="{'invisible': [('state','!=', 'confirmed')]}" type="action" string="Print P2P" class="oe_highlight"  icon="gtk-print"/> 
							<button name="view_po" type="object"   attrs="{'invisible': ['|',('state','!=','confirmed'),('is_type_po','=',False)]}" string="View Purchase Order" class="oe_highlight"></button>
							<button name="view_sd" type="object"  attrs="{'invisible': ['|',('state','!=','confirmed'),('is_type_po','=',True)]}" string="View Stock Distribution" class="oe_highlight"></button>							
							<button name="generate_line" groups='wtc_p2p.group_wtc_p2p_purchase_order_generate' attrs="{'invisible':['|','|',('purchase_line','&lt;&gt;',[]),('state','=','cancel'),('type_name','=','Additional')]}" type="object" string='Generate' class="oe_highlight"/>
							<button name="validate_order" groups='wtc_p2p.group_wtc_p2p_purchase_order_validate' type="object" states="draft" string="Validate" class="oe_highlight"></button>
							<button name="cancel_order" groups='wtc_p2p.group_wtc_p2p_purchase_order_cancel' type="object" states="draft" string="Cancel"></button>						
							<button name="confirm_order" groups='wtc_p2p.group_wtc_p2p_purchase_order_confirm' type="object" attrs="{'invisible': ['|',('state','not in',('approved')),('is_branch','=',False)]}" string="Confirm"  class="oe_highlight"></button>
							<button name="confirm_order_dealer" groups='wtc_p2p.group_wtc_p2p_purchase_order_confirm' type="object" attrs="{'invisible': ['|',('is_branch','!=',False),('state','in',('draft','confirmed','waiting_for_approval','reject','cancel','approved'))]}" string="Confirm"  class="oe_highlight"></button>							
							<button name="action_export_upo" groups='wtc_p2p.group_wtc_p2p_purchase_order_export_upo' type="object" string="Export File" class="oe_highlight" 
							  attrs="{'invisible':['|','|',('state','!=','confirmed'),('branch_type','!=','MD'),('is_branch','=',False)]}"/>		
							<button name="reject_by_ahm" type="object" groups='wtc_p2p.group_wtc_p2p_purchase_order_reject' string="Reject PO"
							   attrs="{'invisible':['|','|',('state','!=','approved'),('branch_type','!=','MD'),('is_branch','=',False)]}"/>								  						
							<field name="state" widget="statusbar" statusbar_visible="draft,validate,approved,confirmed" statusbar_colors='{"draft":"red","approved":"blue"}'/>	
	           		</header>		        	       	
		        	<sheet>
			        	<div class="oe_title">
			        		<h2>
				                <label string="P2P Purchase Order"/>   
				                <field name="name" class="oe_inline" readonly='1'/>			
			 				</h2>
			        	</div>       
						<group>   
							<group>
							    <field name="dealer_id" options="{'no_create': True,'no_open': True}" attrs="{'readonly': ['|',('state','!=','draft'),('name','!=',False)]}"/>								    																	
							</group>            
						    <group>
	                    		<field name="division" required="1" attrs="{'readonly': ['|',('state','!=','draft'),('name','!=',False)]}" />
	                    	</group>
	                    	<group>
								<field name="supplier_id" options="{'no_create': True,'no_open': True}" required="1" attrs="{'readonly': ['|',('state','!=','draft'),('name','!=',False)]}"/>												                    			                    		
							   	<field name="periode_id" options="{'no_create': True,'no_open': True}" required="1" attrs="{'readonly': ['|',('state','!=','draft'),('name','!=',False)]}"/> 							    																	
								<field name='description' attrs="{'readonly': ['|',('state','!=','draft'),('name','!=',False)]}"/>

								 <field name="credit_limit_unit" readonly="True" attrs="{'invisible': [('division','!=','Unit')]}"/>

								 <field name="credit_limit_sparepart" readonly="True" attrs="{'invisible': [('division','!=','Sparepart')]}"/>
							</group>
				            <group> 
				            	<field name="date" readonly="1"/> 
				            	
				            	<field name="purchase_order_type_id" options="{'no_create': True,'no_open': True}" required="1" attrs="{'readonly': ['|',('state','!=','draft'),('name','!=',False)]}"/>
								<field name='is_branch' invisible='1'/>
								<field name='user_id' attrs="{'readonly': ['|',('state','!=','draft'),('name','!=',False)]}"/>
								<field name='is_type_po' invisible='1'/>
								<field name='branch_type' invisible='1'/>
								<field name="type_name" invisible='1'/>
				            </group>   
						</group>	
						
						<notebook colspan="5">
							<page string='Order Line'>
		                        <field colspan="4" name="purchase_line" nolabel="1" widget="one2many_list" 
		                        	attrs="{'readonly': [('state','not in',('draft','validate'))],'invisible':[('type_name','=','Additional')]}">
		                            <tree delete="false" create="false" string="" editable="bottom">
						                <field name="product_id" invisible='1' options="{'no_create': True,'no_open': True}"/>
						                <field name="product_id_show" readonly='1' options="{'no_create': True,'no_open': True}"/>
										<field name="tent1_prev_qty" invisible='1'/>
										<field name="tent1_prev_qty_show" readonly='1'/>						                
						                <field name="fix_qty" string='Fix Qty'/>

										<field name="tent2_prev_qty" invisible='1'/>
										<field name="tent2_prev_qty_show" readonly='1'/>
										<field name="type" invisible='1'/>					                
						                <field name="tent1_qty"  attrs="{'required': [('type','=','Fix')]}" string='Tent 1 Qty'/>

						                <field name="tent2_qty"  attrs="{'required': [('type','=','Fix')]}" string='Tent 2 Qty'/>

						                <field name="qty_available" invisible='1' string='Qty Available' />
										<field name="qty_available_show" readonly='1'/>
						             </tree>
		                        </field>
		                        <field colspan="4" name="additional_line" nolabel="1" widget="one2many_list" 
		                        	attrs="{'readonly': [('state','not in',('draft','validate'))],'invisible':[('type_name','!=','Additional')]}">
		                            <tree string="" editable="bottom">
		                            	<field name="type" invisible='1'/>
						                <field name="product_id" options="{'no_create': True,'no_open': True}" attrs="{'required': [('type','=','Additional')]}"/>						                
						                <field name="fix_qty" string='Fix Qty' sum="Total Qty" attrs="{'required': [('type','=','Additional')]}"/>

						                <field name="qty_available" invisible='1' string='Qty Available' />
										<field name="qty_available_show" readonly='1'/>
						             </tree>
		                        </field>		                        		                        								
							</page>
							<page string="Audit Trail">
								<group>
									<group>
										<field name="create_uid" readonly="1"></field>
										<field name="create_date" readonly="1"></field>
										<field name="confirm_uid" readonly="1"></field>
										<field name="confirm_date" readonly="1"></field>										
									</group>
									<group>							
										<field name="write_uid" readonly="1"></field>
										<field name="write_date" readonly="1"></field>
									</group>
								</group>
							</page>			                    
		                </notebook>				
		           </sheet>
		        </form>
		    </field>
		</record>

		<record id="view_wtc_p2p_purchase_filter" model="ir.ui.view">
            <field name="name">wtc.p2p.purchase.filter</field>
            <field name="model">wtc.p2p.purchase.order</field>
            <field name="arch" type="xml">
                <search string="Search">
                   <field name="name"/>
                   <field name='supplier_id'/>
				   <field name="dealer_id"/>
				   <filter name="draft" string="Draft" domain="[('state','=','draft')]"/>
				   <filter name="validate" string="Validate" domain="[('state','=','validate')]"/>
				   <filter name="waiting_for_approval" string="Waiting For Approval" domain="[('state','=','waiting_for_approval')]"/>
				   <filter name="approved" string="Approved" domain="[('state','=','approved')]"/>
				   <filter name="confirmed" string="Confirmed" domain="[('state','=','confirmed')]"/>
				   <filter name="reject" string="Reject" domain="[('state','=','reject')]"/>
                </search>
            </field>
        </record>		

		<record model="ir.actions.act_window" id="wtc_p2p_purchase_action">
		    <field name="name">P2P Purchase Order</field>
		    <field name="res_model">wtc.p2p.purchase.order</field>
		    <field name="view_type">form</field>
		    <field name="view_mode">tree,form</field>
		</record>
					
		<menuitem id="p2p_purchase_submenu" name="P2P Purchase Order" parent="wtc_dealer_menu.p2p_purchase_menu" action="wtc_p2p_purchase_action" sequence="10"/>    	
    </data>
</openerp>
    