<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>  
    	
		<record id="wtc_approval_so_form_view" model="ir.ui.view">
			<field name="name">wtc.approval.so.form</field>
			<field name="model">sale.order</field>            
    		<field name="inherit_id" ref="sale.view_order_form"/>
			<field name="arch" type="xml">
				
				<button name="action_button_confirm" position="replace">
					<button name="approval_request" states="draft" string="RFA" type="workflow" class="oe_highlight" groups="wtc_sale_order.group_button_sale_order_rfa"/>
					<button name="renew_available" states="draft" string="Renew Available" type="object" class="oe_highlight" groups="wtc_sale_order.group_button_sale_order_renew_available"/>
					<button name="approval_approve" states="waiting_for_approval" string="Approve" type="workflow" class="oe_highlight" groups="wtc_sale_order.group_button_sale_order_approve"/>
					<button name="approval_confirm" states="approved" string="Confirm" type="workflow" class="oe_highlight" groups="wtc_sale_order.group_button_sale_order_confirm"/>
					<button name="%(wtc_approval.wtc_approval_reject_wizard_action)d" states="waiting_for_approval" string="Reject" type="action" context="{'model_name':'sale.order','next_workflow':'approval_reject'}" groups="wtc_sale_order.group_button_sale_order_reject"/>
					<button name="%(wtc_approval.wtc_cancel_approval_wizard)d" states="approved" string="Cancel Approval" type="action" context="{'model_name':'sale.order','next_workflow':'approval_cancel'}"/>
				</button>
				
				<xpath expr="//field[@name='warehouse_id']" position="after">
					<field name='amount_approval' attrs="{'invisible': [('amount_approval','=',0.0)]}" />
				</xpath>

				<xpath expr="//page[@string='Other Information']" position="after">
					<page string="Approval">
						<field name="approval_ids">
							<tree string="Approval" editable="bottom" create="false" edit="false" delete="false" >
								<field name="group_id" />
								<field name="branch_id"/>
								<field name="division"/>
								<field name="limit"/>
								<field name="sts"/>
								<field name="reason"/>
								<field name="pelaksana_id"/>
								<field name="tanggal"/>
							</tree>
						</field>
					</page>
					<page string='Faktur Pajak' attrs="{'invisible': [('amount_tax','=',0)]}"  >
						<group>
							<field name='pajak_gabungan' attrs="{'readonly':[('state','!=','draft')]}"></field>
							<field name='faktur_pajak_id' readonly='1'></field>
						</group>
					</page>
					<page string="Audit Trail">
						<group>
							<group>
								<field name="create_uid" readonly="1"></field>
								<field name="create_date" readonly="1"></field>
								<field name="confirm_uid" readonly="1"></field>
								<field name="confirm_date" readonly="1"></field>
							</group>
							<group>							
								<field name="write_uid" readonly="1"></field>
								<field name="write_date" readonly="1"></field>
								<field name="cancel_uid" readonly="1"></field>
								<field name="cancel_date" readonly="1"></field>
							</group>
						</group>
					</page>				
				</xpath>
				
			</field>
		</record>
		
 	</data>
</openerp>