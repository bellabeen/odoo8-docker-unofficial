<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>

	<!-- Bank Mutasi -->
     	<record id="view_teds_bank_mutasi_reconcile_tree" model="ir.ui.view">
	        <field name="name">teds.bank.muatasi.reconcile.tree</field>
	        <field name="model">teds.bank.mutasi</field>
	        <field name="priority">10</field>
	        <field name="arch" type="xml">
	        	<tree>
					<field name="date"/>
					<field name="name"/>
					<field name="remark"/>
					<field name="no_sistem"/>
					<field name="debit" sum="Total Debit"/>
					<field name="credit" sum="Total Credit"/>
				</tree>
	    	</field>
	    </record>

	    <record id="view_teds_bank_mutasi_reconcile_form" model="ir.ui.view">
	        <field name="name">teds.bank.muatasi.reconcile.form</field>
	        <field name="model">teds.bank.mutasi</field>
	        <field name="priority">10</field>
	        <field name="arch" type="xml">
	        	<form>
	        		<group>
	        			<field name="name" readonly="1"/>
					 	<field name="remark" readonly="1"/>
		 	            <field name="bank_reconcile_id" readonly="1"/>
		                <field name="debit" readonly="1"/>
		                <field name="credit" readonly="1"/>	
		                <field name="amount" readonly="1"/>
		                <field name="coa" readonly="1"/>	
		                <field name="no_sistem" readonly="1"/>	
		                <field name="date" readonly="1" string="Tanggal RK"/>
		                <field name="account_id" readonly="1" options="{'no_open':True,'no_create':True}"/>
		                <field name="journal_id" readonly="1" options="{'no_open':True,'no_create':True}"/>
		                <field name="format" readonly="1"/>
		               <field name="date_upload" readonly="1"/>
	        		</group>
	        	</form>
	        </field>
	    </record>

	<!-- Move Line -->
    	<record id="view_teds_move_line_reconcile_tree" model="ir.ui.view">
            <field name="name">teds.move.line.reconcile.tree</field>
            <field name="model">account.move.line</field>
            <field name="priority">50</field>
            <field name="arch" type="xml">
        		<tree>
        			<field name="period_id" options="{'no_open':True,'no_create':True}"/>
					<field name="date"/>
		     		<!-- <field name="partner_id"/> -->
		     		<field name="name"/>
		     		<field name="ref"/>
		     		<!-- <field name="account_id" options="{'no_open':True,'no_create':True}"/> -->
		     		<field name="debit" sum="Total Debit"/>
		     		<field name="credit" sum="Toral Credit"/>
				</tree>
			</field>
		</record>

		<record id="view_teds_move_line_reconcile_form" model="ir.ui.view">
            <field name="name">teds.move.line.reconcile.form</field>
            <field name="model">account.move.line</field>
            <field name="priority">50</field>
            <field name="arch" type="xml">
        		<form>
        			<group>
						<field name="period_id" options="{'no_open':True,'no_create':True}" readonly="1"/>
						<field name="date" readonly="1"/>
			     		<field name="partner_id" readonly="1"/>
			     		<field name="name" readonly="1"/>
			     		<field name="ref" readonly="1"/>
			     		<field name="account_id" options="{'no_open':True,'no_create':True}" readonly="1"/>
			     		<field name="debit" sum="Total Debit" readonly="1"/>
			     		<field name="credit" sum="Toral Credit" readonly="1"/>
			     	</group>
			     </form>
			</field>
		</record>


    	<record id="teds_bank_reconcile_tree_view" model="ir.ui.view">
            <field name="name">teds.bank.reconcile.tree.view</field>
            <field name="model">teds.bank.reconcile</field>
            <field name="arch" type="xml">
                <tree string="Reconcile Bank">
	                <field name="name"/>
	                <field name="branch_id"/>
		            <field name="account_id"/>
		            <field name="date"/>
		            <field name="state"/>
                </tree>
            </field>
        </record>	
        
        
        <record model="ir.ui.view" id="teds_bank_reconcile_form_view">
		    <field name="name">teds.bank.reconcile.form</field>
		    <field name="model">teds.bank.reconcile</field>
		    <field name="arch" type="xml">
		    	<form string="Bank Reconcile">
		    		<header>
		    			<button name="confirm" states="draft" string="Confirm" type="object" class="oe_highlight" groups="teds_bank_reconcile.group_button_confirm_bank_reconcile"/>
		    			<field name="state" widget="statusbar" statusbar_visible="draft,posted,Auto Reconcile" statusbar_colors='{"draft":"red","posted":"done","Auto Reconcile":"done"}'/>
		    		</header>
		    		<sheet>
		    			<div class="oe_title">
		       				<h1>
					            <field name="name" class="oe_inline" readonly="1"/>
		    			    </h1>
	                    </div>
	                    <group>
	                    	<group col="4">
				    			<field name="branch_id" required="1" options="{'no_create': True,'no_open': True}" attrs="{'readonly': [('state','!=','draft')]}" />
					         	<field name="account_id" required="1" options="{'no_create': True,'no_open': True}" attrs="{'readonly': [('state','!=','draft')]}"/>
						     
					         	<field name="confirm_uid" readonly = "1" attrs="{'invisible':[('state','=','draft')]}"/>
					         	<field name="confirm_date" readonly = "1" attrs="{'invisible':[('state','=','draft')]}"/>
					        </group>
						</group>
						<notebook>
							<page string="Detail">							
					    		<group>
					    			<div class="col-sm-12">
					    				<separator string="Mutasi Bank"/>
										<field name="bank_mutasi_ids" nolabel="1" options="{'no_create': True,'no_open': True}" attrs="{'readonly': [('state','!=','draft')],'invisible':[('account_id','=',False)]}" domain="[('account_id','=',account_id),('reconciled','=',False),('date','!=',False)]" context="{'tree_view_ref':'teds_bank_reconcile.view_teds_bank_mutasi_reconcile_tree','form_view_ref':'teds_bank_reconcile.view_teds_bank_mutasi_reconcile_form'}"/>
					    	
										<separator string="Journal"/>
										<field name="move_line_ids" nolabel="1" options="{'no_create': True,'no_open': True}" attrs="{'readonly': [('state','!=','draft')],'invisible':[('account_id','=',False)]}" domain="[('account_id','=',account_id),('teds_reconciled_rk','=',False)]" context="{'tree_view_ref':'teds_bank_reconcile.view_teds_move_line_reconcile_tree','form_view_ref':'teds_bank_reconcile.view_teds_move_line_reconcile_form'}"/>
					    			</div>	
								</group>
							</page>
							<page string="Audit Trail">
								<group>
									<group>
										<field name="create_uid" readonly="1"></field>
										<field name="create_date" readonly="1"></field>
										<field name="cancel_uid" readonly="1" attrs="{'invisible':[('cancel_uid','=',False)]}"></field>
										<field name="cancel_date" readonly="1" attrs="{'invisible':[('cancel_date','=',False)]}"></field>
									</group>
									<group>							
										<field name="write_uid" readonly="1"></field>
										<field name="write_date" readonly="1"></field>
									</group>
								</group>
							</page>
						</notebook>
		    		</sheet>
		    	</form>
			</field>
		</record>

		<!-- Search -->
		<record id="view_teds_bank_reconcile_filter" model="ir.ui.view">
            <field name="name">teds.bank.reconcile.filter</field>
            <field name="model">teds.bank.reconcile</field>
            <field name="arch" type="xml">
                <search string="Search">
                	<field name="name" string="Name"/>
                    <field name="account_id" string="Account"/>
                    <field name="branch_id" string="Branch"/>
                    <field name="date" string="Date"/>
                    <filter name="state_draft" string="Draft" domain="[('state','=','draft')]"/>
                    <filter name="state_posted" string="Posted" domain="[('state','=','posted')]"/>
                    <filter name="state_auto_reconcile" string="Auto Reconcile" domain="[('state','=','Auto Reconcile')]"/>
                    <filter name="state_cancel" string="Cancelled" domain="[('state','=','cancel')]"/>
		            <field name="bank_mutasi_ids" filter_domain="[('bank_mutasi_ids.name', '=', self)]" string="Bank Mutasi"/>
		            <field name="move_line_ids" filter_domain="['|',('move_line_ids.name', '=', self),('move_line_ids.ref', '=', self)]" string="Journal"/>

                    <group expand="1" string="Group By">
	                    <filter string="Account" name="gby_account_id" context="{'group_by':'account_id'}"/>
	                    <filter string="Branch" name="gby_branch_id" context="{'group_by':'branch_id'}"/>

					</group>	                   

		        </search>
            </field>
        </record> 
		
		<record id="action_teds_bank_reconcile" model="ir.actions.act_window">
             <field name="res_model">teds.bank.reconcile</field>
             <field name="type">ir.actions.act_window</field>
             <field name="view_type">form</field>
             <field name="view_mode">tree,form</field>
             <field name="name">Bank Reconcile</field>
             <field name="context">{'search_default_state_draft':1}</field>
       	</record>
       
       	<menuitem id="teds_bank_reconcile_menuitem"  parent="bank_reconcile_submenu"  action="action_teds_bank_reconcile" sequence="40"/> 	
	</data>
</openerp>