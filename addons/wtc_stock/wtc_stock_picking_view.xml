<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
		
		<record id="stock_picking_wizard_print_view" model="ir.ui.view">
            <field name="name">stock.picking.wizard.print</field>
            <field name="model">stock.picking</field>
            <field name="arch" type="xml">
                <form string="Picking">
           			<button name="%(report_picking_bastk)d" string="BASTK" type="action" class="oe_highlight"/> 
           			<button name="%(report_picking_sj)d" string="Surat Jalan" type="action" class="oe_highlight"/> 
                </form>
            </field>
        </record>
        
		<record model="ir.ui.view" id="wtc_branch_on_stock_picking_form_view">
		    <field name="name">wtc.branch.stock.picking.form</field>
		    <field name="model">stock.picking</field>
		    <field name="inherit_id" ref="stock.view_picking_form"/>
		    <field name="arch" type="xml">
		    	<xpath expr="/form/sheet/group" position="before">
		    		<group>
		    			<group>
			            	<field name="branch_id" options="{'no_open':True,'no_create':True}" on_change="branch_id_change(branch_id)" attrs="{'readonly':[('name','!=',False)]}"/>
			            	<field name="rel_branch_type" invisible="1"/>
			            </group>
			            <group>
							<field name="division" attrs="{'readonly':[('name','!=',False)]}"/>
						</group>
					</group>		            
		    	</xpath>
		     </field>
		</record>

		<record model="ir.ui.view" id="wtc_stock_picking_type_form_view">
		    <field name="name">wtc.stock.picking.type.form</field>
		    <field name="model">stock.picking.type</field>
		    <field name="inherit_id" ref="stock.view_picking_type_form"/>
		    <field name="arch" type="xml">
		    	<xpath expr="//sheet" position="inside">
            		<notebook>
						<page string="Audit Trail">
							<group>
								<group>
									<field name="create_uid" readonly="1"></field>
									<field name="create_date" readonly="1"></field>
								</group>
								<group>							
									<field name="write_uid" readonly="1"></field>
									<field name="write_date" readonly="1"></field>
								</group>
							</group>
						</page>
					</notebook>
		    	</xpath>
		     </field>
		</record>
		
		<record id="wtc_stock_incoterm_form_view" model="ir.ui.view">
			<field name="name">wtc.stock.incoterms</field>
			<field name="model">stock.incoterms</field>
			<field name="inherit_id" ref="stock.stock_incoterms_form"/>
			<field name="arch" type="xml">					
				<xpath expr="//sheet" position="inside">
					<notebook>
						<page string="Audit Trail">
							<group>
								<group>
									<field name="create_uid" readonly="1"></field>
									<field name="create_date" readonly="1"></field>
								</group>
								<group>							
									<field name="write_uid" readonly="1"></field>
									<field name="write_date" readonly="1"></field>
								</group>
							</group>
						</page>
					</notebook>
				</xpath>				
			</field>
		</record>
		
		<record id="wtc_stock_quants_form_view" model="ir.ui.view">
			<field name="name">wtc.stock.quant</field>
			<field name="model">stock.quant</field>
			<field name="inherit_id" ref="stock.view_stock_quant_form"/>
			<field name="arch" type="xml">					
				<xpath expr="//form" position="inside">
					<notebook>
						<page string="Audit Trail">
							<group>
								<group>
									<field name="create_uid" readonly="1"></field>
									<field name="create_date" readonly="1"></field>
								</group>
								<group>							
									<field name="write_uid" readonly="1"></field>
									<field name="write_date" readonly="1"></field>
								</group>
							</group>
						</page>
					</notebook>
				</xpath>				
			</field>
		</record>
		
		<record id="wtc_stock_location_form_view" model="ir.ui.view">
			<field name="name">wtc.stock.location.route</field>
			<field name="model">stock.location.route</field>
			<field name="inherit_id" ref="stock.stock_location_route_form_view"/>
			<field name="arch" type="xml">					
				<xpath expr="//sheet" position="inside">
					<notebook>
						<page string="Audit Trail">
							<group>
								<group>
									<field name="create_uid" readonly="1"></field>
									<field name="create_date" readonly="1"></field>
								</group>
								<group>							
									<field name="write_uid" readonly="1"></field>
									<field name="write_date" readonly="1"></field>
								</group>
							</group>
						</page>
					</notebook>
				</xpath>				
			</field>
		</record>	
		
		<record model="ir.ui.view" id="wtc_view_picking_internal_search">
		    <field name="name">wtc.view.picking.internal.search</field>
		    <field name="model">stock.picking</field>
		    <field name="inherit_id" ref="stock.view_picking_internal_search"/>
		    <field name="arch" type="xml">
		    
		    	<field name="group_id" position="after">
		    		<field name="origin"/>
		    		<field name="division"/>
		    		<field name="backorder_id"/>
		    	</field>
                <xpath expr="//field[@name='product_id']" position="after">                	                  
                    <group expand="1" string="Group By">
                        <filter string="Branch" context="{'group_by':'branch_id'}"/>
                    </group>                 
                </xpath>		    	
		     </field>
		</record>
		
		<record model="ir.ui.view" id="wtc_stock_picking_form_view">
		    <field name="name">wtc.stock.picking.form</field>
		    <field name="model">stock.picking</field>
		    <field name="type">form</field>
		    <field name="inherit_id" ref="stock.view_picking_form"/>
		    <field name="arch" type="xml">
		        
		    	<xpath expr="//button[@name='force_assign']" position="attributes">
					<attribute name="invisible">True</attribute>
				</xpath>
				<button name="do_enter_transfer_details" position="replace">
					<button name="wtc_do_enter_transfer_details" states="assigned,partially_available" string="Transfer" groups="stock.group_stock_user" type="object" class="oe_highlight" invisible="1"/>
					<button name="create_packing" string="Packing" groups="wtc_stock.group_stock_picking_packing" type="object" class="oe_highlight" attrs="{'invisible': ['|',('state','in',['draft','cancel','waiting','confirmed']),'&amp;',('state','in',['draft','cancel','waiting','confirmed','partially_available','assigned'])]}"/>
				</button>
				<button name="wtc_do_enter_transfer_details" position="after">
					<button name="%(report_picking_list)d" string="Print Picking List" type="action" class="oe_highlight" groups="wtc_stock.group_stock_picking_print"/>
				</button>
				<button name="action_cancel" position="attributes">
					<!-- attribute name="attrs">{'invisible':['|','|',('picking_type_code','in',['interbranch_out','interbranch_in']),('is_effective_date','=',False)]}</attribute -->
					<attribute name="invisible">1</attribute>
				</button>
				<button name="do_print_picking" position="attributes">
					<attribute name="invisible">1</attribute>
				</button>
				<button name="action_assign" position="attributes">
					<attribute name="attrs">{'invisible':['|',('is_effective_date','=',False)]}</attribute>
				</button>
				<!-- <button name="rereserve_pick" position="attributes">
					<attribute name="attrs">{'invisible':['|',('is_effective_date','=',False)]}</attribute>
				</button> -->
				<button name="do_unreserve" position="attributes">
					<attribute name="invisible">1</attribute>
				</button>
				
				<button name="%(stock.act_stock_return_picking)d" position="attributes">
					<attribute name="groups">wtc_stock.group_stock_picking_reverse</attribute>
				</button>
				
		    	<field name="partner_id" position="after">
		    		<field name="start_date" attrs="{'readonly':[('state','!=','draft')]}"/>
		    		<field name="end_date" attrs="{'readonly':[('state','!=','draft')]}"/>
		    		<field name="transaction_id" invisible="1"/>
		    		<field name="model_id" invisible="1"/>
		    		<field name="is_effective_date" invisible="1"/>
		    		<field name="is_reverse" invisible="1"/>
		    	</field>
		        <xpath expr="//field[@name='picking_type_id']" position="attributes">
					<attribute name="domain">[('code','=','internal'),('branch_id','=',branch_id)]</attribute>
					<attribute name="options">{'no_open':True,'no_create':True}</attribute>
				</xpath>
		    	<button name="%(stock.act_stock_return_picking)d" position="attributes">
		    		<attribute name="attrs">{'invisible':['|','|',('picking_type_code','in',['internal','interbranch_out','interbranch_in','incoming']),('is_reverse','=',True)]}</attribute>
		    	</button>
            	<xpath expr="//page[@string='Additional Info']" position="after">
						<page string="Audit Trail">
							<group>
								<group>
									<field name="create_uid" readonly="1"></field>
									<field name="create_date" readonly="1"></field>
									<field name="confirm_uid" readonly="1"></field>
									<field name="confirm_date" readonly="1"></field>
								</group>
								<group>							
									<field name="write_uid" readonly="1"></field>
									<field name="write_date" readonly="1"></field>
								</group>
							</group>
						</page>
				</xpath>
				
				<field name="partner_id" position="attributes">
					<attribute name="attrs">{'readonly':[('state','!=','draft')]}</attribute>
				</field>
				<field name="date" position="attributes">
					<attribute name="attrs">{'readonly':[('state','!=','draft')]}</attribute>
				</field>
				<field name="min_date" position="attributes">
					<attribute name="attrs">{'readonly':[('state','!=','draft')]}</attribute>
				</field>
				<field name="origin" position="attributes">
					<attribute name="attrs">{'readonly':[('state','!=','draft')]}</attribute>
				</field>
				<field name="owner_id" position="attributes">
					<attribute name="attrs">{'readonly':[('state','!=','draft')]}</attribute>
				</field>
				<field name="move_type" position="attributes">
					<attribute name="attrs">{'readonly':[('state','!=','draft')]}</attribute>
				</field>
				<field name="invoice_state" position="attributes">
					<attribute name="attrs">{'readonly':[('state','!=','draft')]}</attribute>
				</field>
				<field name="picking_type_id" position="attributes">
					<attribute name="attrs">{'readonly':[('state','!=','draft')]}</attribute>
				</field>
				<field name="date_done" position="attributes">
					<attribute name="attrs">{'readonly':[('state','!=','draft')]}</attribute>
				</field>
				<field name="priority" position="attributes">
					<attribute name="attrs">{'readonly':[('state','!=','draft')]}</attribute>
				</field>
				<field name="move_lines" position="attributes">
					<attribute name="attrs">{'readonly':[('state','!=','draft')]}</attribute>
				</field>
				
			</field>
		</record>
		
        <record id="view_stock_warehouse_orderpoint" model="ir.ui.view">
            <field name="name">wtc.stock.warehouse.orderpoint</field>
            <field name="model">stock.warehouse.orderpoint</field>
            <field name="inherit_id" ref="stock.view_warehouse_orderpoint_form"/>
            <field name="arch" type="xml">
            	<xpath expr="//sheet" position="inside">
            		<notebook>
						<page string="Audit Trail">
							<group>
								<group>
									<field name="create_uid" readonly="1"></field>
									<field name="create_date" readonly="1"></field>
								</group>
								<group>							
									<field name="write_uid" readonly="1"></field>
									<field name="write_date" readonly="1"></field>
								</group>
							</group>
						</page>
					</notebook>
				</xpath> 
            </field>
        </record>
        
		<record id="vpicktree_internal" model="ir.ui.view">
            <field name="name">stock.picking.internal.tree</field>
            <field name="model">stock.picking</field>
            <field name="priority">20</field>
            <field name="arch" type="xml">
                <tree string="Picking list">
                    <field name="name"/>
                    <field name="location_dest_id"/>
                    <!--field name="partner_id"/-->
                    <field name="date"/>
                    <field name="min_date" invisible="1"/>
                    <field name="origin"/>
                    <field name="group_id" invisible="1"/>
                    <field name="backorder_id"/>
                    <field name="state"/>
                    <field name="priority" invisible="1"/>
                    <field name="picking_type_id" invisible="1"/>
                    <field name="picking_type_code" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="view_picking_internal_form" model="ir.ui.view">
            <field name="name">stock.picking.internal.form</field>
            <field name="model">stock.picking</field>
            <field name="arch" type="xml">
                <form string="Transfer">
	                <header>
						<button name="%(report_internal_transfer)d" states="done" type="action" string="Print" class="oe_highlight"  icon="gtk-print" groups="wtc_stock.group_stock_picking_internal_transfer_print"/>
	                	<button name="action_confirm" states="draft" string="Confirm" type="object" class="oe_highlight" groups="base.group_user"/>
	                	<button name="renew_available" states="draft" string="Renew Available" type="object" class="oe_highlight" groups="base.group_user"/>
	                	<button name="action_assign" states="confirmed,partially_available" string="Check Availability" type="object" class="oe_highlight" groups="base.group_user"/>
	                	<button name="wtc_do_enter_transfer_details" states="assigned,partially_available" string="Transfer" groups="stock.group_stock_user" type="object" class="oe_highlight" invisible="1"/>
						<button name="do_transfer" states="assigned,partially_available" string="Transfer" groups="stock.group_stock_user" type="object" class="oe_highlight"/>
	                	<button name="action_cancel" states="assigned,confirmed,partially_available" string="Cancel Transfer" groups="base.group_user" type="object"/>
	                    <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,partially_available,assigned,done" statusbar_colors='{"shipping_except":"red","invoice_except":"red","waiting_date":"blue"}'/>
	                </header>
                	<sheet>
		                <div class="oe_title">
		       				<h1>
					            <label string="Internal Transfer"/>
					 			<field name="name" class="oe_inline" readonly="1"/>
		    			    </h1>
	                    </div>
	                	<group col="4">
				            <field name="branch_id" options="{'no_show':True,'no_create':True,'no_open':True}" required="True" attrs="{'readonly':[('name','!=',False)]}"/>
				            <field name="division" required="True" attrs="{'readonly':[('name','!=',False)]}"/>
				            <field name="picking_type_id" on_change="type_change(picking_type_id)" attrs="{'readonly':[('state','!=','draft')]}" domain="[('code','=','internal'),('branch_id','=',branch_id)]" options="{'no_show':True,'no_create':True,'no_open':True}"/>
				            <field name="picking_type_code" invisible="1" on_change="internal_location_change()"/>
				            <field name="date" attrs="{'readonly':[('state','!=','draft')]}"/>
				            <field name="internal_location_id" options="{'no_show':True,'no_create':True,'no_open':True}" attrs="{'readonly':[('state','!=','draft')]}" on_change="internal_location_change()" domain="[('usage','in',('internal','nrfs')),('branch_id','=',branch_id)]"/>
				            <field name="internal_location_dest_id" options="{'no_show':True,'no_create':True,'no_open':True}" attrs="{'readonly':[('state','!=','draft')]}" on_change="internal_location_change()" domain="[('usage','in',('internal','nrfs')),('branch_id','=',branch_id),('end_date','&gt;=',context_today().strftime('%%Y-%%m-%%d')),('start_date','&lt;=',context_today().strftime('%%Y-%%m-%%d'))]"/>
				            <field name="location_id" invisible="1"/>
				            <field name="location_dest_id" invisible="1"/>
						</group>
						<notebook>
	                        <page string="Products">
	                            <field colspan="4" name="move_lines" nolabel="1" widget="one2many_list" attrs="{'readonly': [('state','in',['cancel','assigned','done'])]}">
	                            	<tree string="Product" editable="top">
	                            		<field name="branch_id" invisible="1"/>
	                            		<field name="func_division" invisible="1"/>
	                                    <field name="categ_id" options="{'no_show':True,'no_create':True,'no_open':True}" invisible="1"/>
	                            		<field name="product_id" on_change="internal_product_qty_change(stock_available,parent.branch_id,parent.division,product_id,product_uom_qty,parent.picking_type_id,parent.internal_location_id,parent.internal_location_dest_id,restrict_lot_id)" options="{'no_show':True,'no_create':True,'no_open':True}" domain="[('id','=',0)]"/>
	                            		<field name="name"/>
	                            		<field name="restrict_lot_id" domain="[('id','=',0)]" options="{'no_open':True,'no_create':True}" attrs="{'required': [('func_division','=','Unit')], 'readonly': [('func_division','!=','Unit')]}" on_change="lot_qty_change(product_uom_qty,product_uom,restrict_lot_id)"/>
	                            		<field name="is_rfs" attrs="{'readonly': [('func_division','!=','Unit')]}"/>
	                            		<field name="product_uom_qty" on_change="internal_product_qty_change(stock_available,parent.branch_id,parent.division,product_id,product_uom_qty,parent.picking_type_id,parent.internal_location_id,parent.internal_location_dest_id,restrict_lot_id)"/>
	                            		<field name="product_uom" invisible="1"/>
	                            		<field name="product_uos" invisible="1"/>
	                            		<field name="product_uos_qty" invisible="1"/>
	                            		<field name="picking_type_id" invisible="1"/>
	                            		<field name="location_id" invisible="1"/>
	                            		<field name="location_dest_id" invisible="1"/>
	                            		<field name="state"/>
	                            		<field name="stock_available" invisible="1" on_change="internal_stock_available_change(stock_available)"/>
	                            		<field name="rel_stock_available" readonly="1"/>
	                                </tree>
		                        </field>
	                            <field name="pack_operation_exist" invisible="1"/>
	                            <field name="note" invisible="1" placeholder="Add an internal note..." class="oe_inline"/>
	                        </page>
	                        <page string="Operations" attrs="{'invisible': ['|', ('state','!=','done'), ('pack_operation_ids','=',[])]}">
	                            <field name="pack_operation_ids" context="{'default_picking_id': active_id, 'default_location_id': location_id, 'default_location_dest_id': location_dest_id}">
	                                <tree editable="top">
	                                    <field name="package_id" invisible="1" groups="stock.group_tracking_lot"/>
	                                    <field name="product_id" on_change="product_id_change(product_id, product_uom_id, product_qty)"/>
	                                    <field name="product_uom_id" invisible="1" groups="product.group_uom"/>
	                                    <field name="lot_id" domain="[('product_id','=?', product_id)]" context="{'product_id': product_id}" groups="stock.group_production_lot"/>
	                                    <field name="picking_id" invisible="1"/>
	                                    <field name="owner_id" invisible="1" groups="stock.group_tracking_owner"/>
	                                    <field name="product_qty" attrs="{'required': [('product_id', '!=', False)]}"/>
	                                    <field name="location_id" invisible="1" domain="[('id', 'child_of', parent.location_id)]"/>
	                                    <field name="location_dest_id" invisible="1" domain="[('id', 'child_of', parent.location_dest_id)]"/>
	                                    <field name="result_package_id" invisible="1" groups="stock.group_tracking_lot" context="{'location_id': location_dest_id}"/>
	                                </tree>
	                            </field>
	                            <p class="oe_grey" groups="stock.group_tracking_lot">
	                            If there is no product but a source package, this means the source package was moved entirely.  If there is a product and a source package, the product was taken from the source package.  
	                            </p>
	                        </page>
							<page string="Audit Trail">
								<group>
									<group>
										<field name="create_uid" readonly="1"></field>
										<field name="create_date" readonly="1"></field>
									</group>
									<group>							
										<field name="write_uid" readonly="1"></field>
										<field name="write_date" readonly="1"></field>
									</group>
								</group>
							</page>	                        
	                	</notebook>
	                </sheet>
                </form>
            </field>
        </record>
        
		<record model="ir.actions.act_window" id="wtc_picking_internal_action">
            <field name="name">Internal Transfer</field>
            <field name="res_model">stock.picking</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('picking_type_code','=','internal')]</field>
		    <field name="context">{"search_default_draft":1,
		    	"search_default_waiting":1,
		    	"search_default_confirmed":1,
		    	"search_default_available":1}</field>
                        
        </record>
        
        <record id="wtc_picking_internal_action_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="vpicktree_internal"/>
            <field name="act_window_id" ref="wtc_picking_internal_action"/>
        </record>
        
        <record id="wtc_picking_internal_action_form" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_picking_internal_form"/>
            <field name="act_window_id" ref="wtc_picking_internal_action"/>
        </record>
        
        <menuitem action="wtc_picking_internal_action" id="wtc_picking_internal_menu_showroom" parent="wtc_dealer_menu.showroom_mutasi_menu" sequence="1"/>
        <menuitem action="wtc_picking_internal_action" id="wtc_picking_internal_menu_workshop" parent="wtc_dealer_menu.workshop_mutasi_menu" sequence="1"/>
        
	</data>
</openerp>